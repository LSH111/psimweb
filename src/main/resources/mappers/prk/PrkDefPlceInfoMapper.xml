<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.psim.web.prk.mapper.PrkDefPlceInfoMapper">

    <sql id="parkingCommonWhere">
        <where>
            tcl.use_yn = 'Y'
            <if test="userBizList != null and userBizList.size() > 0">
                AND tbppi.prk_biz_mng_no IN
                <foreach collection="userBizList" item="bizNo" open="(" separator="," close=")">
                    #{bizNo}
                </foreach>
            </if>
            <!-- ÏãúÎèÑ/ÏãúÍµ∞Íµ¨ ÌïÑÌÑ∞: sidoCd/sigunguCd Ïö∞ÏÑ†, Íµ¨ ÌÇ§(sido/sigungu)ÎèÑ Ìò∏Ìôò -->
            <if test="sidoCd != null and sidoCd != ''">
                AND tcl.sido_cd = #{sidoCd}
            </if>
            <if test="(sidoCd == null or sidoCd == '') and (sido != null and sido != '')">
                AND tcl.sido_cd = #{sido}
            </if>

            <if test="sigunguCd != null and sigunguCd != ''">
                AND tcl.sigungu_cd = #{sigunguCd}
            </if>
            <if test="(sigunguCd == null or sigunguCd == '') and (sigungu != null and sigungu != '')">
                AND tcl.sigungu_cd = #{sigungu}
            </if>
            <if test="emd != null and emd != ''">
                AND tcl.emd_cd = #{emd}
            </if>
            <if test="prkNm != null and prkNm != ''">
                AND tpdpi.prkplce_nm LIKE CONCAT('%', #{prkNm}, '%')
            </if>
            <if test="prkType != null and prkType != ''">
                AND tpdpi.prk_plce_type = #{prkType}
            </if>
        </where>
    </sql>

    <select id="selectParkingList" parameterType="map" resultType="com.psim.web.prk.vo.ParkingListVO">
        SELECT
        cpk.FN_GET_CODE_NM(tbppi.prgs_sts_cd, 'PRK_013') as prgsStsCd,
        tcl.sido_cd as sidoCd,
        tcl.sido_nm as sidoNm,
        tcl.sigungu_cd as sigunguCd,
        tcl.sigungu_nm as sigunguNm,
        tcl.emd_cd as emdCd,
        tcl.lgal_emd_nm as lgalEmdNm,
        tpdpi.zip as zip,
        tpdpi.dtadd as dtadd,
        tcu.user_nm as userNm,
        tpdpi.prk_plce_type as prkPlceTypeCd,
        cpk.FN_GET_CODE_NM(tpdpi.prk_plce_type, 'P_PRKPLCE_SE') as prkPlceType,
        tpdpi.prkplce_nm as prkplceNm,
        tbppi.biz_per_prk_mng_no as bizPerPrkMngNo,
        tbppi.prk_biz_mng_no as prkBizMngNo,
        tbppi.prk_plce_manage_no as prkPlceManageNo,
        tbppi.prk_plce_info_sn as prkPlceInfoSn
        FROM cpk.tb_prk_def_plce_info tpdpi
        LEFT JOIN cpk.tb_co_ldong tcl
        ON tpdpi.ldong_cd = tcl.ldong_cd
        LEFT JOIN cpk.tb_biz_per_prklot_info tbppi
        ON tpdpi.prk_plce_manage_no = tbppi.prk_plce_manage_no
        AND tpdpi.prk_plce_info_sn = tbppi.prk_plce_info_sn
        LEFT JOIN cpk.tb_co_user tcu
        ON tbppi.srvy_id = tcu.user_id
        <include refid="parkingCommonWhere"/>
        ORDER BY tpdpi.prkplce_nm ASC
        <!-- ÌéòÏù¥Ïßï Ï†úÍ±∞: LIMIT/OFFSET Íµ¨Î¨∏ ÏÇ≠Ï†ú -->
    </select>

    <!-- selectParkingListCountÎäî Îçî Ïù¥ÏÉÅ ÌïÑÏöîÌïòÏßÄ ÏïäÏßÄÎßå Ìò∏ÌôòÏÑ±ÏùÑ ÏúÑÌï¥ Ïú†ÏßÄ -->
    <select id="selectParkingListCount" parameterType="map" resultType="int">
        SELECT COUNT(*)
        FROM cpk.tb_prk_def_plce_info tpdpi
        LEFT JOIN cpk.tb_co_ldong tcl
        ON tpdpi.ldong_cd = tcl.ldong_cd
        LEFT JOIN cpk.tb_biz_per_prklot_info tbppi
        ON tpdpi.prk_plce_manage_no = tbppi.prk_plce_manage_no
        AND tpdpi.prk_plce_info_sn = tbppi.prk_plce_info_sn
        LEFT JOIN cpk.tb_co_user tcu
        ON tbppi.srvy_id = tcu.user_id
        <include refid="parkingCommonWhere"/>
    </select>

    <select id="selectParkingDetail" parameterType="map" resultType="com.psim.web.prk.vo.ParkingListVO">
        SELECT
        cpk.FN_GET_CODE_NM(tbppi.prgs_sts_cd, 'PRK_013') as prgsStsCd,
        tcl.sido_cd as sidoCd,
        tcl.sido_nm as sidoNm,
        tcl.sigungu_cd as sigunguCd,
        tcl.sigungu_nm as sigunguNm,
        tcl.emd_cd as emdCd,
        tcl.lgal_emd_nm as lgalEmdNm,
        tpdpi.zip as zip,
        tpdpi.dtadd as dtadd,
        tcu.user_nm as userNm,
        cpk.FN_GET_CODE_NM(tpdpi.prk_plce_type, 'P_PRKPLCE_SE') as prkPlceType,
        tpdpi.prkplce_nm as prkplceNm,
        tbppi.biz_per_prk_mng_no as bizPerPrkMngNo,
        tbppi.prk_biz_mng_no as prkBizMngNo,
        tbppi.prk_plce_manage_no as prkPlceManageNo,
        tbppi.prk_plce_info_sn as prkPlceInfoSn
        FROM cpk.tb_prk_def_plce_info tpdpi
        LEFT JOIN cpk.tb_co_ldong tcl
        ON tpdpi.ldong_cd = tcl.ldong_cd
        LEFT JOIN cpk.tb_biz_per_prklot_info tbppi
        ON tpdpi.prk_plce_manage_no = tbppi.prk_plce_manage_no
        AND tpdpi.prk_plce_info_sn = tbppi.prk_plce_info_sn
        LEFT JOIN cpk.tb_co_user tcu
        ON tbppi.srvy_id = tcu.user_id
        WHERE tcl.use_yn = 'Y'
        <if test="prkPlceManageNo != null">
            AND tbppi.prk_plce_manage_no = #{prkPlceManageNo}
        </if>
        <if test="prkPlceInfoSn != null">
            AND tbppi.prk_plce_info_sn = #{prkPlceInfoSn}
        </if>
    </select>

    <update id="updateParkingStatus" parameterType="map">
        UPDATE cpk.tb_biz_per_prklot_info
        SET prgs_sts_cd    = #{prgsStsCd},
            updt_dt        = NOW(),
            updusr_id      = #{updusrId},
            updusr_ip_addr = #{updusrIpAddr}
        WHERE prk_plce_manage_no = #{prkPlceManageNo}
          AND prk_plce_info_sn = #{prkPlceInfoSn}
    </update>

    <update id="updateSelectedParking" parameterType="map">
        UPDATE cpk.tb_prk_def_plce_info
        SET prkplce_nm     = #{prkplceNm},
            zip            = #{zip},
            dtadd          = #{dtadd},
            updt_dt        = NOW(),
            updusr_id      = #{updusrId},
            updusr_ip_addr = #{updusrIpAddr}
        WHERE prk_plce_manage_no = #{prkPlceManageNo}
          AND prk_plce_info_sn = #{prkPlceInfoSn}
    </update>

    <!-- ÎÖ∏ÏÉÅÏ£ºÏ∞®Ïû• ÏÉÅÏÑ∏ Ï°∞Ìöå ÏøºÎ¶¨ -->
    <select id="selectOnstreetParkingDetail" parameterType="map"
            resultType="com.psim.web.prk.vo.ParkingDetailVO">
        SELECT cpk.FN_GET_CODE_NM(tbppi.prgs_sts_cd, 'PRK_013') as prgsStsCd
             , tbppi.prgs_sts_cd                                as prgsStsRawCd
             , tbppi.rejt_rsn                                   as rejtRsn
             , tpsbi.prk_biz_mng_no                             as prkBizMngNo
             , tpsbi.biz_nm                                     as bizNm
             , tpsbi.biz_yy                                     as bizYy
             , tpsbi.biz_exc_st_dt                              as bizExcStDt
             , tpsbi.biz_exc_ed_dt                              as bizExcEdDt
             , tpdpi.prk_plce_manage_no                         as prkPlceManageNo
             , tpdpi.prk_plce_info_sn                           as prkPlceInfoSn
             , tpdpi.prkplce_nm                                 as prkplceNm
             , tcl.sido_cd                                      as sidoCd
             , tcl.sido_nm                                      as sidoNm
             , tcl.sigungu_cd                                   as sigunguCd
             , tcl.sigungu_nm                                   as sigunguNm
             , tcl.emd_cd                                       as emdCd
             , tcl.lgal_emd_nm                                  as lgalEmdNm
             , tpdpi.zip                                        as zip
             , tpdpi.dtadd                                      as dtadd
             , tpdpi.roadadd                                    as rnmadr
             , tpdpi.prk_plce_lat                               as prkPlceLat
             , tpdpi.prk_plce_lon                               as prkPlceLon
             -- üî• ÎàÑÎùΩÎêú ÌïÑÎìú Ï∂îÍ∞Ä
             , tpdpi.bdnbr                                      as bdnbr
             , tpdpi.lnm_mnno                                   as lnmMnno
             , tpdpi.lnm_sbno                                   as lnmSbno
             , tpdpi.mntn_yn                                    as mntnYn
             , tpdpi.li_cd                                      as liCd
             , topi.tot_prk_cnt                                 as totPrkCnt
             , topi.disab_prk_cnt                               as disabPrkCnt
             , topi.compact_prk_cnt                             as compactPrkCnt
             , topi.eco_prk_cnt                                 as ecoPrkCnt
             , topi.pregnant_prk_cnt                            as pregnantPrkCnt
             , topi.prk_oper_mthd_cd                            as prkOperMthdCd
             , topi.oper_mby_cd                                 as operMbyCd
             , topi.mgr_org                                     as mgrOrg
             , topi.mgr_org_tel_no                              as mgrOrgTelNo
             , topi.subordn_opertn_cd                           as subordnOpertnCd
             , topoi.dynt_dv_cd                                 as dyntDvCd
             , topoi.wk_zon                                     as wkZon
             , topoi.wk_wkdy_oper_tm_cd                         as wkWkdyOperTmCd
             , topoi.wk_wkdy_oper_star_tm                       as wkWkdyOperStarTm
             , topoi.wk_wkdy_oper_end_tm                        as wkWkdyOperEndTm
             , topoi.wk_sat_oper_tm_cd                          as wkSatOperTmCd
             , topoi.wk_sat_oper_star_tm                        as wkSatOperStarTm
             , topoi.wk_sat_oper_end_tm                         as wkSatOperEndTm
             , topoi.wk_hldy_oper_tm_cd                         as wkHldyOperTmCd
             , topoi.wk_hldy_oper_star_tm                       as wkHldyOperStarTm
             , topoi.wk_hldy_oper_end_tm                        as wkHldyOperEndTm
             , topoi.nt_zon                                     as ntZon
             , topoi.nt_wkdy_oper_tm_cd                         as ntWkdyOperTmCd
             , topoi.nt_wkdy_oper_star_tm                       as ntWkdyOperStarTm
             , topoi.nt_wkdy_oper_end_tm                        as ntWkdyOperEndTm
             , topoi.nt_sat_oper_tm_cd                          as ntSatOperTmCd
             , topoi.nt_sat_oper_star_tm                        as ntSatOperStarTm
             , topoi.nt_sat_oper_end_tm                         as ntSatOperEndTm
             , topoi.nt_hldy_oper_tm_cd                         as ntHldyOperTmCd
             , topoi.nt_hldy_oper_star_tm                       as ntHldyOperStarTm
             , topoi.nt_hldy_oper_end_tm                        as ntHldyOperEndTm
             , topoi.wk_fee_aply_cd                             as wkFeeAplyCd
             , topoi.wk_res_day_fee                             as wkResDayFee
             , topoi.wk_res_wk_fee                              as wkResWkFee
             , topoi.wk_res_ft_fee                              as wkResFtFee
             , topoi.wk_res_nt_fee                              as wkResNtFee
             , topoi.wk_gn_frst_30m_fee                         as wkGnFrst30mFee
             , topoi.wk_gn_int_10m_fee                          as wkGnInt10mFee
             , topoi.wk_gn_1h_fee                               as wkGn1hFee
             , topoi.wk_gn_day_fee                              as wkGnDayFee
             , topoi.wk_fee_mthd_cd                             as wkFeeMthdCd
             , topoi.wk_fee_stlmt_mthd_cd                       as wkFeeStlmtMthdCd
             , topoi.nt_fee_stlmt_mthd_cd                       as ntFeeStlmtMthdCd
             , topoi.nt_fee_aply_cd                             as ntFeeAplyCd
             , topoi.nt_res_day_fee                             as ntResDayFee
             , topoi.nt_res_wk_fee                              as ntResWkFee
             , topoi.nt_res_ft_fee                              as ntResFtFee
             , topoi.nt_res_nt_fee                              as ntResNtFee
             , topoi.nt_gn_frst_30m_fee                         as ntGnFrst30mFee
             , topoi.nt_gn_int_10m_fee                          as ntGnInt10mFee
             , topoi.nt_gn_1h_fee                               as ntGn1hFee
             , topoi.nt_gn_day_fee                              as ntGnDayFee
             , topoi.nt_fee_mthd_cd                             as ntFeeMthdCd
             , topoi.prklot_sign_yn                             as prklotSignYn
             , topoi.slp_sec_yn                                 as slpSecYn
             , topoi.sixle_cnt                                  as sixleCnt
             , topoi.sixgt_cnt                                  as sixgtCnt
             , topoi.antislp_fclty_yn                           as antislpFcltyYn
             , topoi.slp_ctn_guid_sign_yn                       as slpCtnGuidSignYn
             , topoi.partclr_matter                             as partclrMatter
             , topoi.wk_fee_mnth_pass_prc                       as wkFeeMnthPassPrc
             , topoi.nt_fee_mnth_pass_prc                       as ntFeeMnthPassPrc
             , topoi.wk_fee_hfyr_pass_prc                       as wkFeeHfyrPassPrc
             , topoi.nt_fee_hfyr_pass_prc                       as ntFeeHfyrPassPrc
             , topoi.wk_fee_pay_mthd_othr                       as wkFeePayMthdOthr
             , topoi.nt_fee_pay_mthd_othr                       as ntFeePayMthdOthr
        FROM cpk.tb_prk_def_plce_info tpdpi
                 LEFT JOIN cpk.tb_onstr_prklot_info topi
                           ON tpdpi.prk_plce_manage_no = topi.prk_plce_manage_no
                               AND tpdpi.prk_plce_info_sn = topi.prk_plce_info_sn
                 LEFT JOIN cpk.tb_onstr_prklot_oper_info topoi
                           ON topi.prk_plce_manage_no = topoi.prk_plce_manage_no
                               AND topi.prk_plce_info_sn = topoi.prk_plce_info_sn
                 LEFT JOIN cpk.tb_co_ldong tcl
                           ON tpdpi.ldong_cd = tcl.ldong_cd
                 LEFT JOIN cpk.tb_biz_per_prklot_info tbppi
                           ON tpdpi.prk_plce_manage_no = tbppi.prk_plce_manage_no
                               AND tpdpi.prk_plce_info_sn = tbppi.prk_plce_info_sn
                 LEFT JOIN cpk.tb_prk_srvy_biz_info tpsbi
                           ON tbppi.prk_biz_mng_no = tpsbi.prk_biz_mng_no
                               AND tpsbi.use_yn = 'Y'
        WHERE tpdpi.prk_plce_manage_no = #{prkPlceManageNo}
          AND tpdpi.prk_plce_info_sn = #{prkPlceInfoSn}
    </select>

    <!-- üî• Í∏∞Î≥∏ Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏ (tb_prk_def_plce_info) -->
    <update id="updatePrkDefPlceInfo" parameterType="com.psim.web.prk.vo.ParkingDetailVO">
        UPDATE cpk.tb_prk_def_plce_info
        SET prkplce_nm     = #{prkplceNm},
            ldong_cd       = #{ldongCd},
            sido_cd        = #{sidoCd},
            sigungu_cd     = #{sigunguCd},
            emd_cd         = #{emdCd},
            zip            = #{zip},
            dtadd          = #{dtadd},
            prk_plce_lat   = #{prkPlceLat},
            prk_plce_lon   = #{prkPlceLon},
            bdnbr          = #{bdnbr},
            lnm_mnno       = #{lnmMnno},
            lnm_sbno       = #{lnmSbno},
            mntn_yn        = #{mntnYn},
            li_cd          = #{liCd},
            roadadd        = #{roadaddr},
            updt_dt        = NOW(),
            updusr_id      = #{updusrId},
            updusr_ip_addr = #{updusrIpAddr}
        WHERE prk_plce_manage_no = #{prkPlceManageNo}
          AND prk_plce_info_sn = #{prkPlceInfoSn}
    </update>

    <!-- üî• ÎÖ∏ÏÉÅÏ£ºÏ∞®Ïû• Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏ (tb_onstr_prklot_info) -->
    <update id="updateOnstrPrklotInfo" parameterType="com.psim.web.prk.vo.ParkingDetailVO">
        UPDATE cpk.tb_onstr_prklot_info
        SET prkplce_se        = #{prkplceSe}
          , tot_prk_cnt       = #{totPrkCnt}
          , disab_prk_cnt     = #{disabPrkCnt}
          , compact_prk_cnt   = #{compactPrkCnt}
          , eco_prk_cnt       = #{ecoPrkCnt}
          , pregnant_prk_cnt  = #{pregnantPrkCnt}
          , prk_oper_mthd_cd  = #{prkOperMthdCd}
          , oper_mby_cd       = #{operMbyCd}
          , mgr_org           = #{mgrOrg}
          , mgr_org_tel_no    = #{mgrOrgTelNo}
          , subordn_opertn_cd = #{subordnOpertnCd}
          , updt_dt           = NOW()
          , updusr_id         = #{updusrId}
          , updusr_ip_addr    = #{updusrIpAddr}
        WHERE prk_plce_manage_no = #{prkPlceManageNo}
          AND prk_plce_info_sn = #{prkPlceInfoSn}
    </update>

    <!-- üî• Ïö¥ÏòÅ Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏ (tb_onstr_prklot_oper_info) -->
    <update id="updateOnstrPrklotOperInfo" parameterType="com.psim.web.prk.vo.ParkingDetailVO">
        UPDATE cpk.tb_onstr_prklot_oper_info
        SET dynt_dv_cd           = #{dyntDvCd}
          , wk_zon               = #{wkZon}
          , wk_wkdy_oper_tm_cd   = #{wkWkdyOperTmCd}
          , wk_wkdy_oper_star_tm = #{wkWkdyOperStarTm}
          , wk_wkdy_oper_end_tm  = #{wkWkdyOperEndTm}
          , wk_sat_oper_tm_cd    = #{wkSatOperTmCd}
          , wk_sat_oper_star_tm  = #{wkSatOperStarTm}
          , wk_sat_oper_end_tm   = #{wkSatOperEndTm}
          , wk_hldy_oper_tm_cd   = #{wkHldyOperTmCd}
          , wk_hldy_oper_star_tm = #{wkHldyOperStarTm}
          , wk_hldy_oper_end_tm  = #{wkHldyOperEndTm}
          , nt_zon               = #{ntZon}
          , nt_wkdy_oper_tm_cd   = #{ntWkdyOperTmCd}
          , nt_wkdy_oper_star_tm = #{ntWkdyOperStarTm}
          , nt_wkdy_oper_end_tm  = #{ntWkdyOperEndTm}
          , nt_sat_oper_tm_cd    = #{ntSatOperTmCd}
          , nt_sat_oper_star_tm  = #{ntSatOperStarTm}
          , nt_sat_oper_end_tm   = #{ntSatOperEndTm}
          , nt_hldy_oper_tm_cd   = #{ntHldyOperTmCd}
          , nt_hldy_oper_star_tm = #{ntHldyOperStarTm}
          , nt_hldy_oper_end_tm  = #{ntHldyOperEndTm}
          , wk_fee_aply_cd       = #{wkFeeAplyCd}
          , wk_res_day_fee       = #{wkResDayFee}
          , wk_res_wk_fee        = #{wkResWkFee}
          , wk_res_ft_fee        = #{wkResFtFee}
          , wk_res_nt_fee        = #{wkResNtFee}
          , wk_gn_frst_30m_fee   = #{wkGnFrst30mFee}
          , wk_gn_int_10m_fee    = #{wkGnInt10mFee}
          , wk_gn_1h_fee         = #{wkGn1hFee}
          , wk_gn_day_fee        = #{wkGnDayFee}
          , wk_fee_mnth_pass_prc = #{wkFeeMnthPassPrc}
          , wk_fee_hfyr_pass_prc = #{wkFeeHfyrPassPrc}
          , wk_fee_mthd_cd       = #{wkFeeMthdCd}
          , wk_fee_stlmt_mthd_cd = #{wkFeeStlmtMthdCd}
          , wk_fee_pay_mthd_othr = #{wkFeePayMthdOthr}
          , nt_fee_aply_cd       = #{ntFeeAplyCd}
          , nt_res_day_fee       = #{ntResDayFee}
          , nt_res_wk_fee        = #{ntResWkFee}
          , nt_res_ft_fee        = #{ntResFtFee}
          , nt_res_nt_fee        = #{ntResNtFee}
          , nt_gn_frst_30m_fee   = #{ntGnFrst30mFee}
          , nt_gn_int_10m_fee    = #{ntGnInt10mFee}
          , nt_gn_1h_fee         = #{ntGn1hFee}
          , nt_gn_day_fee        = #{ntGnDayFee}
          , nt_fee_mnth_pass_prc = #{ntFeeMnthPassPrc}
          , nt_fee_hfyr_pass_prc = #{ntFeeHfyrPassPrc}
          , nt_fee_mthd_cd       = #{ntFeeMthdCd}
          , nt_fee_stlmt_mthd_cd = #{ntFeeStlmtMthdCd}
          , nt_fee_pay_mthd_othr = #{ntFeePayMthdOthr}
          , prklot_sign_yn       = #{prklotSignYn}
          , slp_sec_yn           = #{slpSecYn}
          , sixle_cnt            = #{sixleCnt}
          , sixgt_cnt            = #{sixgtCnt}
          , antislp_fclty_yn     = #{antislpFcltyYn}
          , slp_ctn_guid_sign_yn = #{slpCtnGuidSignYn}
          , partclr_matter       = #{partclrMatter}
          , updt_dt              = NOW()
          , updusr_id            = #{updusrId}
          , updusr_ip_addr       = #{updusrIpAddr}
        WHERE prk_plce_manage_no = #{prkPlceManageNo}
          AND prk_plce_info_sn = #{prkPlceInfoSn}
    </update>

    <!-- üî• ÏßÑÌñâÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏ (tb_biz_per_prklot_info) -->
    <update id="updateBizPerPrklotPrgsSts" parameterType="com.psim.web.prk.vo.ParkingDetailVO">
        UPDATE cpk.tb_biz_per_prklot_info
        SET prgs_sts_cd = '10'
        WHERE prk_plce_manage_no = #{prkPlceManageNo}
          AND prk_biz_mng_no = #{prkBizMngNo}
    </update>

    <!-- üî• ÎÖ∏Ïô∏Ï£ºÏ∞®Ïû• ÏÉÅÏÑ∏ Ï°∞Ìöå ÏøºÎ¶¨ -->
    <select id="selectOffstreetParkingDetail" parameterType="map" resultType="com.psim.web.prk.vo.ParkingDetailVO">
        SELECT cpk.FN_GET_CODE_NM(tbppi.prgs_sts_cd, 'PRK_013') as prgsStsCd
             , tbppi.prgs_sts_cd                                as prgsStsRawCd
             , tbppi.rejt_rsn                                   as rejtRsn
             , tpsbi.prk_biz_mng_no                             as prkBizMngNo
             , tpdpi.prk_plce_info_sn                           AS prkPlceInfoSn
             , tpsbi.biz_nm                                     as bizNm
             , tpsbi.biz_yy                                     as bizYy
             , tpsbi.biz_exc_st_dt                              as bizExcStDt
             , tpsbi.biz_exc_ed_dt                              as bizExcEdDt
             , tpdpi.prk_plce_manage_no                         as prkPlceManageNo
             , tpdpi.prkplce_nm                                 as prkplceNm
             , tcl.sido_cd                                      as sidoCd
             , tcl.sido_nm                                      as sidoNm
             , tcl.sigungu_cd                                   as sigunguCd
             , tcl.sigungu_nm                                   as sigunguNm
             , tcl.emd_cd                                       as emdCd
             , tcl.lgal_emd_nm                                  as lgalEmdNm
             , tpdpi.dtadd                                      as dtadd
             , tpdpi.prk_plce_lat                               as prkPlceLat
             , tpdpi.prk_plce_lon                               as prkPlceLon
             , topi.tot_prk_cnt                                 as totPrkCnt
             , topi.disab_prk_cnt                               as disabPrkCnt
             , topi.compact_prk_cnt                             as compactPrkCnt
             , topi.eco_prk_cnt                                 as ecoPrkCnt
             , topi.pregnant_prk_cnt                            as pregnantPrkCnt
             , topi.prk_oper_mthd_cd                            as prkOperMthdCd
             , topi.oper_mby_cd                                 as operMbyCd
             , topi.mgr_org                                     as mgrOrg
             , topi.mgr_org_tel_no                              as mgrOrgTelNo
             , topi.subordn_opertn_cd                           as subordnOpertnCd
             , topoi.dynt_dv_cd                                 as dyntDvCd
             , topoi.wk_zon                                     as wkZon
             , topoi.wk_wkdy_oper_tm_cd                         as wkWkdyOperTmCd
             , topoi.wk_wkdy_oper_star_tm                       as wkWkdyOperStarTm
             , topoi.wk_wkdy_oper_end_tm                        as wkWkdyOperEndTm
             , topoi.wk_sat_oper_tm_cd                          as wkSatOperTmCd
             , topoi.wk_sat_oper_star_tm                        as wkSatOperStarTm
             , topoi.wk_sat_oper_end_tm                         as wkSatOperEndTm
             , topoi.wk_hldy_oper_tm_cd                         as wkHldyOperTmCd
             , topoi.wk_hldy_oper_star_tm                       as wkHldyOperStarTm
             , topoi.wk_hldy_oper_end_tm                        as wkHldyOperEndTm
             , topoi.nt_zon                                     as ntZon
             , topoi.nt_wkdy_oper_tm_cd                         as ntWkdyOperTmCd
             , topoi.nt_wkdy_oper_star_tm                       as ntWkdyOperStarTm
             , topoi.nt_wkdy_oper_end_tm                        as ntWkdyOperEndTm
             , topoi.nt_sat_oper_tm_cd                          as ntSatOperTmCd
             , topoi.nt_sat_oper_star_tm                        as ntSatOperStarTm
             , topoi.nt_sat_oper_end_tm                         as ntSatOperEndTm
             , topoi.nt_hldy_oper_tm_cd                         as ntHldyOperTmCd
             , topoi.nt_hldy_oper_star_tm                       as ntHldyOperStarTm
             , topoi.nt_hldy_oper_end_tm                        as ntHldyOperEndTm
             , topoi.wk_fee_aply_cd                             as wkFeeAplyCd
             , topoi.wk_res_day_fee                             as wkResDayFee
             , topoi.wk_res_wk_fee                              as wkResWkFee
             , topoi.wk_res_ft_fee                              as wkResFtFee
             , topoi.wk_res_nt_fee                              as wkResNtFee
             , topoi.wk_gn_frst_30m_fee                         as wkGnFrst30mFee
             , topoi.wk_gn_int_10m_fee                          as wkGnInt10mFee
             , topoi.wk_gn_1h_fee                               as wkGn1hFee
             , topoi.wk_gn_day_fee                              as wkGnDayFee
             , topoi.wk_fee_mthd_cd                             as wkFeeMthdCd
             , topoi.wk_fee_stlmt_mthd_cd                       as wkFeeStlmtMthdCd
             , topoi.nt_fee_aply_cd                             as ntFeeAplyCd
             , topoi.nt_fee_stlmt_mthd_cd                       as ntFeeStlmtMthdCd
             , topoi.nt_res_day_fee                             as ntResDayFee
             , topoi.nt_res_wk_fee                              as ntResWkFee
             , topoi.nt_res_ft_fee                              as ntResFtFee
             , topoi.nt_res_nt_fee                              as ntResNtFee
             , topoi.nt_gn_frst_30m_fee                         as ntGnFrst30mFee
             , topoi.nt_gn_int_10m_fee                          as ntGnInt10mFee
             , topoi.nt_gn_1h_fee                               as ntGn1hFee
             , topoi.nt_gn_day_fee                              as ntGnDayFee
             , topoi.nt_fee_mthd_cd                             as ntFeeMthdCd
             , topoi.prklot_sign_yn                             as prklotSignYn
             , topoi.tckt_mchn_yn                               as tcktMchnYn
             , topoi.barr_gte_yn                                as barrGteYn
             , topoi.exit_alrm_yn                               as exitAlrmYn
             , topoi.veh_rcgn_tp_cd                             as vehRcgnTpCd
             , topoi.wk_peak_str_tm                             as wkPeakStrTm
             , topoi.wk_peak_end_tm                             as wkPeakEndTm
             , topoi.wk_prk_veh_cnt                             as wkPrkVehCnt
             , topoi.nt_peak_str_tm                             as ntPeakStrTm
             , topoi.nt_peak_end_tm                             as ntPeakEndTm
             , topoi.nt_prk_veh_cnt                             as ntPrkVehCnt
             , topoi.prklot_entr_lat                            as prklotEntrLat
             , topoi.prklot_entr_lon                            as prklotEntrLon
             , topoi.bldg_2f_prklot_cd                          as bldg2fPrklotCd
             , topoi.fall_prev_fclty_yn                         as fallPrevFcltyYn
             , topoi.slp_yn                                     as slpYn
             , topoi.slp_7gt_area_cnt                           as slp7gtAreaCnt
             , topoi.antislp_fclty_yn                           as antislpFcltyYn
             , topoi.slp_ctn_guid_sign_yn                       as slpCtnGuidSignYn
             , topoi.spd_bump_qty                               as spdBumpQty
             , topoi.stop_line_qty                              as stopLineQty
             , topoi.crswlk_qty                                 as crswlkQty
             , topoi.partclr_matter                             as partclrMatter
             , topoi.wk_fee_mnth_pass_prc                       as wkFeeMnthPassPrc
             , topoi.nt_fee_mnth_pass_prc                       as ntFeeMnthPassPrc
             , topoi.wk_fee_hfyr_pass_prc                       as wkFeeHfyrPassPrc
             , topoi.nt_fee_hfyr_pass_prc                       as ntFeeHfyrPassPrc
             , topoi.wk_fee_pay_mthd_othr                       as wkFeePayMthdOthr
             , topoi.nt_fee_pay_mthd_othr                       as ntFeePayMthdOthr
        FROM cpk.tb_prk_def_plce_info tpdpi
                 INNER JOIN cpk.tb_offstr_prklot_info topi
                            ON tpdpi.prk_plce_manage_no = topi.prk_plce_manage_no
                 INNER JOIN cpk.tb_offstr_prklot_oper_info topoi
                            ON topi.prk_plce_manage_no = topoi.prk_plce_manage_no
                 LEFT JOIN cpk.tb_co_ldong tcl
                           ON tpdpi.ldong_cd = tcl.ldong_cd
                 INNER JOIN cpk.tb_biz_per_prklot_info tbppi
                            ON tpdpi.prk_plce_manage_no = tbppi.prk_plce_manage_no
                                AND tpdpi.prk_plce_info_sn = tbppi.prk_plce_info_sn
                 INNER JOIN cpk.tb_prk_srvy_biz_info tpsbi
                            ON tbppi.prk_biz_mng_no = tpsbi.prk_biz_mng_no
                                AND tpsbi.use_yn = 'Y'
        WHERE tpdpi.prk_plce_manage_no = #{prkPlceManageNo}
          AND tpdpi.prk_plce_info_sn = #{prkPlceInfoSn}
    </select>

    <!-- üî• ÎÖ∏Ïô∏Ï£ºÏ∞®Ïû• Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏ (tb_offstr_prklot_info) -->
    <update id="updateOffstrPrklotInfo" parameterType="com.psim.web.prk.vo.ParkingDetailVO">
        UPDATE cpk.tb_offstr_prklot_info
        SET prkplce_se        = #{prkplceSe}
          , tot_prk_cnt       = #{totPrkCnt}
          , disab_prk_cnt     = #{disabPrkCnt}
          , compact_prk_cnt   = #{compactPrkCnt}
          , eco_prk_cnt       = #{ecoPrkCnt}
          , pregnant_prk_cnt  = #{pregnantPrkCnt}
          , prk_oper_mthd_cd  = #{prkOperMthdCd}
          , oper_mby_cd       = #{operMbyCd}
          , mgr_org           = #{mgrOrg}
          , mgr_org_tel_no    = #{mgrOrgTelNo}
          , subordn_opertn_cd = #{subordnOpertnCd}
          , updt_dt           = NOW()
          , updusr_id         = #{updusrId}
          , updusr_ip_addr    = #{updusrIpAddr}
        WHERE prk_plce_manage_no = #{prkPlceManageNo}
    </update>

    <!-- üî• ÎÖ∏Ïô∏Ï£ºÏ∞®Ïû• Ïö¥ÏòÅ Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏ (tb_offstr_prklot_oper_info) -->
    <update id="updateOffstrPrklotOperInfo" parameterType="com.psim.web.prk.vo.ParkingDetailVO">
        UPDATE cpk.tb_offstr_prklot_oper_info
        SET dynt_dv_cd           = #{dyntDvCd}
          , wk_zon               = #{wkZon}
          , wk_wkdy_oper_tm_cd   = #{wkWkdyOperTmCd}
          , wk_wkdy_oper_star_tm = #{wkWkdyOperStarTm}
          , wk_wkdy_oper_end_tm  = #{wkWkdyOperEndTm}
          , wk_sat_oper_tm_cd    = #{wkSatOperTmCd}
          , wk_sat_oper_star_tm  = #{wkSatOperStarTm}
          , wk_sat_oper_end_tm   = #{wkSatOperEndTm}
          , wk_hldy_oper_tm_cd   = #{wkHldyOperTmCd}
          , wk_hldy_oper_star_tm = #{wkHldyOperStarTm}
          , wk_hldy_oper_end_tm  = #{wkHldyOperEndTm}
          , nt_zon               = #{ntZon}
          , nt_wkdy_oper_tm_cd   = #{ntWkdyOperTmCd}
          , nt_wkdy_oper_star_tm = #{ntWkdyOperStarTm}
          , nt_wkdy_oper_end_tm  = #{ntWkdyOperEndTm}
          , nt_sat_oper_tm_cd    = #{ntSatOperTmCd}
          , nt_sat_oper_star_tm  = #{ntSatOperStarTm}
          , nt_sat_oper_end_tm   = #{ntSatOperEndTm}
          , nt_hldy_oper_tm_cd   = #{ntHldyOperTmCd}
          , nt_hldy_oper_star_tm = #{ntHldyOperStarTm}
          , nt_hldy_oper_end_tm  = #{ntHldyOperEndTm}
          , wk_fee_aply_cd       = #{wkFeeAplyCd}
          , wk_res_day_fee       = #{wkResDayFee}
          , wk_res_wk_fee        = #{wkResWkFee}
          , wk_res_ft_fee        = #{wkResFtFee}
          , wk_res_nt_fee        = #{wkResNtFee}
          , wk_gn_frst_30m_fee   = #{wkGnFrst30mFee}
          , wk_gn_int_10m_fee    = #{wkGnInt10mFee}
          , wk_gn_1h_fee         = #{wkGn1hFee}
          , wk_gn_day_fee        = #{wkGnDayFee}
          , wk_fee_mnth_pass_prc = #{wkFeeMnthPassPrc}
          , wk_fee_hfyr_pass_prc = #{wkFeeHfyrPassPrc}
          , wk_fee_mthd_cd       = #{wkFeeMthdCd}
          , wk_fee_stlmt_mthd_cd = #{wkFeeStlmtMthdCd}
          , wk_fee_pay_mthd_othr = #{wkFeePayMthdOthr}
          , nt_fee_aply_cd       = #{ntFeeAplyCd}
          , nt_res_day_fee       = #{ntResDayFee}
          , nt_res_wk_fee        = #{ntResWkFee}
          , nt_res_ft_fee        = #{ntResFtFee}
          , nt_res_nt_fee        = #{ntResNtFee}
          , nt_gn_frst_30m_fee   = #{ntGnFrst30mFee}
          , nt_gn_int_10m_fee    = #{ntGnInt10mFee}
          , nt_gn_1h_fee         = #{ntGn1hFee}
          , nt_gn_day_fee        = #{ntGnDayFee}
          , nt_fee_mnth_pass_prc = #{ntFeeMnthPassPrc}
          , nt_fee_hfyr_pass_prc = #{ntFeeHfyrPassPrc}
          , nt_fee_mthd_cd       = #{ntFeeMthdCd}
          , nt_fee_stlmt_mthd_cd = #{ntFeeStlmtMthdCd}
          , nt_fee_pay_mthd_othr = #{ntFeePayMthdOthr}
          , prklot_sign_yn       = #{prklotSignYn}
          , tckt_mchn_yn         = #{tcktMchnYn}
          , barr_gte_yn          = #{barrGteYn}
          , exit_alrm_yn         = #{exitAlrmYn}
          , veh_rcgn_tp_cd       = #{vehRcgnTpCd}
          , wk_peak_str_tm       = #{wkPeakStrTm}
          , wk_peak_end_tm       = #{wkPeakEndTm}
          , wk_prk_veh_cnt       = #{wkPrkVehCnt}
          , nt_peak_str_tm       = #{ntPeakStrTm}
          , nt_peak_end_tm       = #{ntPeakEndTm}
          , nt_prk_veh_cnt       = #{ntPrkVehCnt}
          , prklot_entr_lat      = #{prklotEntrLat}
          , prklot_entr_lon      = #{prklotEntrLon}
          , bldg_2f_prklot_cd    = #{bldg2fPrklotCd}
          , fall_prev_fclty_yn   = #{fallPrevFcltyYn}
          , slp_yn               = #{slpYn}
          , slp_7gt_area_cnt     = #{slp7gtAreaCnt}
          , antislp_fclty_yn     = #{antislpFcltyYn}
          , slp_ctn_guid_sign_yn = #{slpCtnGuidSignYn}
          , spd_bump_qty         = #{spdBumpQty}
          , stop_line_qty        = #{stopLineQty}
          , crswlk_qty           = #{crswlkQty}
          , partclr_matter       = #{partclrMatter}
          , updt_dt              = NOW()
          , updusr_id            = #{updusrId}
          , updusr_ip_addr       = #{updusrIpAddr}
        WHERE prk_plce_manage_no = #{prkPlceManageNo}
    </update>

    <!-- üî• Î∂ÄÏÑ§Ï£ºÏ∞®Ïû• ÏÉÅÏÑ∏ Ï°∞Ìöå ÏøºÎ¶¨ -->
    <select id="selectBuildParkingDetail" parameterType="map" resultType="com.psim.web.prk.vo.ParkingDetailVO">
        SELECT cpk.FN_GET_CODE_NM(tbppi.prgs_sts_cd, 'PRK_013') as prgsStsCd
             , tbppi.prgs_sts_cd                                as prgsStsRawCd
             , tbppi.rejt_rsn                                   as rejtRsn
             , tbppi.biz_per_prk_mng_no                         as bizPerPrkMngNo
             , tpsbi.prk_biz_mng_no                             as prkBizMngNo
             , tpsbi.biz_nm                                     as bizNm
             , tpsbi.biz_yy                                     as bizYy
             , tpsbi.biz_exc_st_dt                              as bizExcStDt
             , tpsbi.biz_exc_ed_dt                              as bizExcEdDt
             , tpdpi.prk_plce_info_sn                           as prkPlceInfoSn
             , tpdpi.prk_plce_manage_no                         as prkPlceManageNo
             , tpdpi.prk_plce_type                              as prkPlceType
             , tpdpi.prkplce_nm                                 as prkplceNm
             , tapi.prkplce_se                                  as ownCd
             , tcl.sido_cd                                      as sidoCd
             , tcl.sido_nm                                      as sidoNm
             , tcl.sigungu_cd                                   as sigunguCd
             , tcl.sigungu_nm                                   as sigunguNm
             , tcl.emd_cd                                       as emdCd
             , tcl.lgal_emd_nm                                  as lgalEmdNm
             , tpdpi.dtadd                                      as dtadd
             , tpdpi.bdnbr                                      as bdnbr
             , tpdpi.zip                                        as zip
             , tpdpi.prk_plce_lat                               as prkPlceLat
             , tpdpi.prk_plce_lon                               as prkPlceLon
             , tpdpi.closed_yn                                  as closedYn
             -- Î∂ÄÏÑ§Ï£ºÏ∞®Ïû• Í∏∞Î≥∏ Ï†ïÎ≥¥
             , cpk.FN_GET_CODE_NM(tapi.prkplce_se, 'PRK_001')   as prkplceSe
             , tapi.tot_prk_cnt                                 as totPrkCnt
             , tapi.disab_prk_cnt                               as disabPrkCnt
             , tapi.compact_prk_cnt                             as compactPrkCnt
             , tapi.eco_prk_cnt                                 as ecoPrkCnt
             , tapi.pregnant_prk_cnt                            as pregnantPrkCnt
             , tapi.oper_mby_cd                                 as operMbyCd
             , tapi.mgr_org                                     as mgrOrg
             , tapi.mgr_org_tel_no                              as mgrOrgTelNo
             , tapi.subordn_opertn_cd                           as subordnOpertnCd
             , tapi.trut_comp_nm                                as trutCompNm
             , tapi.dirt_comp_nm                                as dirtCompNm
             -- Î∂ÄÏÑ§Ï£ºÏ∞®Ïû• Ïö¥ÏòÅ Ï†ïÎ≥¥
             , tapoi.prmisn_dt                                  as prmisnDt
             , tapoi.use_insp_dt                                as useInspDt
             , tapoi.plot_ar                                    as plotAr
             , tapoi.myeon_ar                                   as myeonAr
             , tapoi.mech_prklot_tp_cd                          as mechPrklotTpCd
             , tapoi.mech_prklot_oper_yn                        as mechPrklotOperYn
             , tapoi.mech_prk_inop_cnt                          as mechPrkInopCnt
             , tapoi.prk_fclty_tp_tot_flr_capa                  as prkFcltyTpTotFlrCapa
             , tapoi.prk_fclty_tp_tot_deck_capa                 as prkFcltyTpTotDeckCapa
             -- Ïã§ÎÇ¥ ÏûêÏ£ºÏãù
             , tapoi.indr_self_tot_space_cnt                    as indrSelfTotSpaceCnt
             , tapoi.indr_self_flr_cnt                          as indrSelfFlrCnt
             , tapoi.indr_self_deck_cnt                         as indrSelfDeckCnt
             -- Ïã§ÎÇ¥ Í∏∞Í≥ÑÏãù
             , tapoi.indr_mech_tot_space_cnt                    as indrMechTotSpaceCnt
             , tapoi.indr_mech_flr_cnt                          as indrMechFlrCnt
             , tapoi.indr_mech_deck_cnt                         as indrMechDeckCnt
             -- Ïã§Ïô∏ ÏûêÏ£ºÏãù
             , tapoi.outdr_self_tot_space_cnt                   as outdrSelfTotSpaceCnt
             , tapoi.outdr_self_flr_cnt                         as outdrSelfFlrCnt
             , tapoi.outdr_self_check_cnt                       as outdrSelfCheckCnt
             -- Ïã§Ïô∏ Í∏∞Í≥ÑÏãù
             , tapoi.outdr_mech_tot_space_cnt                   as outdrMechTotSpaceCnt
             , tapoi.outdr_mech_flr_cnt                         as outdrMechFlrCnt
             , tapoi.outdr_mech_deck_cnt                        as outdrMechDeckCnt
             -- Ïö¥ÏòÅÏãúÍ∞Ñ
             , tapoi.wkdy_oper_tm_cd                            as wkdyOperTmCd
             , tapoi.wkdy_tmbas_oper_str_tm                     as wkdyTmbasOperStrTm
             , tapoi.wkdy_tmbas_oper_end_tm                     as wkdyTmbasOperEndTm
             , tapoi.sat_oper_tm_cd                             as satOperTmCd
             , tapoi.sat_tmbas_oper_str_tm                      as satTmbasOperStrTm
             , tapoi.sat_tmbas_oper_end_tm                      as satTmbasOperEndTm
             , tapoi.hldy_oper_tm_cd                            as hldyOperTmCd
             , tapoi.hldy_tmbas_oper_str_tm                     as hldyTmbasOperStrTm
             , tapoi.hldy_tmbas_oper_end_tm                     as hldyTmbasOperEndTm
             -- ÏöîÍ∏à Ï†ïÎ≥¥
             , tapoi.fee_imps_cd                                as feeImpsCd
             , tapoi.fee_frst_30min_prc                         as feeFrst30minPrc
             , tapoi.fee_10min_prc                              as fee10minPrc
             , tapoi.fee_1hr_prc                                as fee1hrPrc
             , tapoi.fee_day_prc                                as feeDayPrc
             , tapoi.fee_mnth_pass_prc                          as feeMnthPassPrc
             , tapoi.fee_hfyr_pass_prc                          as feeHfyrPassPrc
             , tapoi.fee_pay_mthd_cd                            as feePayMthdCd
             , tapoi.fee_pay_mthd_othr                          as feePayMthdOthr
             , tapoi.fee_setl_mthd_cd                           as feeSetlMthdCd
             -- ÏãúÏÑ§ Ï†ïÎ≥¥
             , tapoi.prklot_sign_cd                             as prklotSignCd
             , tapoi.tckt_mchn_yn                               as tcktMchnYn
             , tapoi.barr_gte_yn                                as barrGteYn
             , tapoi.exit_alrm_yn                               as exitAlrmYn
             , tapoi.veh_rcgn_tp_cd                             as vehRcgnTpCd
             -- Ï£ºÏ∞® ÌòÑÌô©
             , tapoi.wk_peak_str_tm                             as wkPeakStrTm
             , tapoi.wk_peak_end_tm                             as wkPeakEndTm
             , tapoi.wk_prk_veh_cnt                             as wkPrkVehCnt
             , tapoi.nt_peak_str_tm                             as ntPeakStrTm
             , tapoi.nt_peak_end_tm                             as ntPeakEndTm
             , tapoi.nt_prk_veh_cnt                             as ntPrkVehCnt
             , tapoi.prklot_entr_lat                            as prklotEntrLat
             , tapoi.prklot_entr_lon                            as prklotEntrLon
             -- üî• Í∏âÏßÄ Ï†ïÎ≥¥ Ï∂îÍ∞Ä
             , tapoi.al_zon                                     as chrgGrdCd
             -- Í∏∞ÌÉÄ Ï†ïÎ≥¥
             , tapoi.pbl_open_yn                                as pblOpenYn
             , tapoi.prklot_info_prvsn_cnst_yn                  as prklotInfoPrvsnCnstYn
             , tapoi.bldg_2f_prklot_cd                          as bldg2fPrklotCd
             , tapoi.fall_prev_fclty_yn                         as fallPrevFcltyYn
             , tapoi.slp_yn                                     as slpYn
             , tapoi.antislp_fclty_yn                           as antislpFcltyYn
             , tapoi.slp_ctn_guid_sign_yn                       as slpCtnGuidSignYn
             , tapoi.spd_bump_qty                               as spdBumpQty
             , tapoi.stop_line_qty                              as stopLineQty
             , tapoi.crswlk_qty                                 as crswlkQty
             , tapoi.guid_doc_yn                                as guidDocYn
             , tapoi.safe_insp_yn                               as safeInspYn
             , tapoi.mgr_yn                                     as mgrYn
             , tapoi.adm_yn                                     as admYn
             , tapoi.partclr_matter                             as partclrMatter
             -- Îì±Î°ù/ÏàòÏ†ï Ï†ïÎ≥¥
             , tpdpi.reg_dt                                     as regDt
             , tpdpi.rgst_id                                    as rgstId
             , tpdpi.updt_dt                                    as updtDt
             , tpdpi.updusr_id                                  as updusrId
        FROM cpk.tb_prk_def_plce_info tpdpi
                 INNER JOIN cpk.tb_atch_prklot_info tapi
                            ON tpdpi.prk_plce_manage_no = tapi.prk_plce_manage_no
                                AND tpdpi.prk_plce_info_sn = tapi.prk_plce_info_sn
                 INNER JOIN cpk.tb_atch_prklot_oper_info tapoi
                            ON tapi.prk_plce_manage_no = tapoi.prk_plce_manage_no
                                AND tapi.prk_plce_info_sn = tapoi.prk_plce_info_sn
                 LEFT JOIN cpk.tb_co_ldong tcl
                           ON tpdpi.ldong_cd = tcl.ldong_cd
                 INNER JOIN cpk.tb_biz_per_prklot_info tbppi
                            ON tpdpi.prk_plce_manage_no = tbppi.prk_plce_manage_no
                                AND tpdpi.prk_plce_info_sn = tbppi.prk_plce_info_sn
                 INNER JOIN cpk.tb_prk_srvy_biz_info tpsbi
                            ON tbppi.prk_biz_mng_no = tpsbi.prk_biz_mng_no
                                AND tpsbi.use_yn = 'Y'
        WHERE tpdpi.prk_plce_manage_no = #{prkPlceManageNo}
          AND tpdpi.prk_plce_info_sn = #{prkPlceInfoSn}
    </select>

    <!-- üî• Î∂ÄÏÑ§Ï£ºÏ∞®Ïû• Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏ (tb_atch_prklot_info) -->
    <update id="updateAtchPrklotInfo" parameterType="com.psim.web.prk.vo.ParkingDetailVO">
        UPDATE cpk.tb_atch_prklot_info
        SET prkplce_se        = #{prkplceSe}
          , tot_prk_cnt       = #{totPrkCnt}
          , disab_prk_cnt     = #{disabPrkCnt}
          , compact_prk_cnt   = #{compactPrkCnt}
          , eco_prk_cnt       = #{ecoPrkCnt}
          , pregnant_prk_cnt  = #{pregnantPrkCnt}
          , oper_mby_cd       = #{operMbyCd}
          , mgr_org           = #{mgrOrg}
          , mgr_org_tel_no    = #{mgrOrgTelNo}
          , subordn_opertn_cd = #{subordnOpertnCd}
          , updt_dt           = NOW()
          , updusr_id         = #{updusrId}
          , updusr_ip_addr    = #{updusrIpAddr}
        WHERE prk_plce_manage_no = #{prkPlceManageNo}
          AND prk_plce_info_sn = #{prkPlceInfoSn}
    </update>

    <!-- üî• Î∂ÄÏÑ§Ï£ºÏ∞®Ïû• Ïö¥ÏòÅ Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏ (tb_atch_prklot_oper_info) -->
    <update id="updateAtchPrklotOperInfo" parameterType="com.psim.web.prk.vo.ParkingDetailVO">
        UPDATE cpk.tb_atch_prklot_oper_info
        SET prklot_sign_cd       = #{prklotSignCd}
          , tckt_mchn_yn         = #{tcktMchnYn}
          , barr_gte_yn          = #{barrGteYn}
          , exit_alrm_yn         = #{exitAlrmYn}
          , veh_rcgn_tp_cd       = #{vehRcgnTpCd}
          , wk_peak_str_tm       = #{wkPeakStrTm}
          , wk_peak_end_tm       = #{wkPeakEndTm}
          , wk_prk_veh_cnt       = #{wkPrkVehCnt}
          , nt_peak_str_tm       = #{ntPeakStrTm}
          , nt_peak_end_tm       = #{ntPeakEndTm}
          , nt_prk_veh_cnt       = #{ntPrkVehCnt}
          , prklot_entr_lat      = #{prklotEntrLat}
          , prklot_entr_lon      = #{prklotEntrLon}
          , bldg_2f_prklot_cd    = #{bldg2fPrklotCd}
          , fall_prev_fclty_yn   = #{fallPrevFcltyYn}
          , slp_yn               = #{slpYn}
          , antislp_fclty_yn     = #{antislpFcltyYn}
          , slp_ctn_guid_sign_yn = #{slpCtnGuidSignYn}
          , spd_bump_qty         = #{spdBumpQty}
          , stop_line_qty        = #{stopLineQty}
          , crswlk_qty           = #{crswlkQty}
          , al_zon               = #{chrgGrdCd}
          , partclr_matter       = #{partclrMatter}
          , updt_dt              = NOW()
          , updusr_id            = #{updusrId}
          , updusr_ip_addr       = #{updusrIpAddr}
        WHERE prk_plce_manage_no = #{prkPlceManageNo}
          AND prk_plce_info_sn = #{prkPlceInfoSn}
    </update>

    <!-- üî• ÎÖ∏Ïô∏Ï£ºÏ∞®Ïû• Ï†ïÎ≥¥ INSERT (tb_offstr_prklot_info) -->
    <insert id="insertOffstrPrklotInfo" parameterType="com.psim.web.prk.vo.ParkingDetailVO">
        INSERT INTO cpk.tb_offstr_prklot_info (prk_plce_manage_no,
                                               prk_plce_info_sn,
                                               prkplce_se,
                                               tot_prk_cnt,
                                               disab_prk_cnt,
                                               compact_prk_cnt,
                                               eco_prk_cnt,
                                               pregnant_prk_cnt,
                                               prk_oper_mthd_cd,
                                               oper_mby_cd,
                                               mgr_org,
                                               mgr_org_tel_no,
                                               subordn_opertn_cd,
                                               reg_dt,
                                               rgst_id,
                                               rgst_ip_addr,
                                               updt_dt,
                                               updusr_id,
                                               updusr_ip_addr)
        VALUES (#{prkPlceManageNo},
                #{prkPlceInfoSn},
                #{prkplceSe},
                #{totPrkCnt},
                #{disabPrkCnt},
                #{compactPrkCnt},
                #{ecoPrkCnt},
                #{pregnantPrkCnt},
                #{prkOperMthdCd},
                #{operMbyCd},
                #{mgrOrg},
                #{mgrOrgTelNo},
                #{subordnOpertnCd},
                NOW(),
                #{updusrId},
                #{updusrIpAddr},
                NOW(),
                #{updusrId},
                #{updusrIpAddr})
    </insert>

    <!-- üî• ÎÖ∏Ïô∏Ï£ºÏ∞®Ïû• Ïö¥ÏòÅ Ï†ïÎ≥¥ INSERT (tb_offstr_prklot_oper_info) -->
    <insert id="insertOffstrPrklotOperInfo" parameterType="com.psim.web.prk.vo.ParkingDetailVO">
        INSERT INTO cpk.tb_offstr_prklot_oper_info (prk_plce_manage_no,
                                                    prk_plce_info_sn,
                                                    dynt_dv_cd,
                                                    wk_zon,
                                                    wk_wkdy_oper_tm_cd,
                                                    wk_wkdy_oper_star_tm,
                                                    wk_wkdy_oper_end_tm,
                                                    wk_sat_oper_tm_cd,
                                                    wk_sat_oper_star_tm,
                                                    wk_sat_oper_end_tm,
                                                    wk_hldy_oper_tm_cd,
                                                    wk_hldy_oper_star_tm,
                                                    wk_hldy_oper_end_tm,
                                                    nt_zon,
                                                    nt_wkdy_oper_tm_cd,
                                                    nt_wkdy_oper_star_tm,
                                                    nt_wkdy_oper_end_tm,
                                                    nt_sat_oper_tm_cd,
                                                    nt_sat_oper_star_tm,
                                                    nt_sat_oper_end_tm,
                                                    nt_hldy_oper_tm_cd,
                                                    nt_hldy_oper_star_tm,
                                                    nt_hldy_oper_end_tm,
                                                    wk_fee_aply_cd,
                                                    wk_res_day_fee,
                                                    wk_res_wk_fee,
                                                    wk_res_ft_fee,
                                                    wk_gn_frst_30m_fee,
                                                    wk_gn_int_10m_fee,
                                                    wk_gn_1h_fee,
                                                    wk_gn_day_fee,
                                                    wk_fee_mnth_pass_prc,
                                                    wk_fee_hfyr_pass_prc,
                                                    wk_fee_mthd_cd,
                                                    wk_fee_stlmt_mthd_cd,
                                                    wk_fee_pay_mthd_othr,
                                                    nt_fee_aply_cd,
                                                    nt_res_day_fee,
                                                    nt_res_wk_fee,
                                                    nt_res_nt_fee,
                                                    nt_gn_frst_30m_fee,
                                                    nt_gn_int_10m_fee,
                                                    nt_gn_1h_fee,
                                                    nt_gn_day_fee,
                                                    nt_fee_mnth_pass_prc,
                                                    nt_fee_hfyr_pass_prc,
                                                    nt_fee_mthd_cd,
                                                    nt_fee_stlmt_mthd_cd,
                                                    nt_fee_pay_mthd_othr,
                                                    prklot_sign_yn,
                                                    tckt_mchn_yn,
                                                    barr_gte_yn,
                                                    exit_alrm_yn,
                                                    veh_rcgn_tp_cd,
                                                    wk_peak_str_tm,
                                                    wk_peak_end_tm,
                                                    wk_prk_veh_cnt,
                                                    nt_peak_str_tm,
                                                    nt_peak_end_tm,
                                                    nt_prk_veh_cnt,
                                                    prklot_entr_lat,
                                                    prklot_entr_lon,
                                                    bldg_2f_prklot_cd,
                                                    fall_prev_fclty_yn,
                                                    slp_yn,
                                                    slp_7gt_area_cnt,
                                                    antislp_fclty_yn,
                                                    slp_ctn_guid_sign_yn,
                                                    spd_bump_qty,
                                                    stop_line_qty,
                                                    crswlk_qty,
                                                    partclr_matter,
                                                    reg_dt,
                                                    rgst_id,
                                                    rgst_ip_addr,
                                                    updt_dt,
                                                    updusr_id,
                                                    updusr_ip_addr)
        VALUES (#{prkPlceManageNo},
                #{prkPlceInfoSn},
                #{dyntDvCd},
                #{wkZon},
                #{wkWkdyOperTmCd},
                #{wkWkdyOperStarTm},
                #{wkWkdyOperEndTm},
                #{wkSatOperTmCd},
                #{wkSatOperStarTm},
                #{wkSatOperEndTm},
                #{wkHldyOperTmCd},
                #{wkHldyOperStarTm},
                #{wkHldyOperEndTm},
                #{ntZon},
                #{ntWkdyOperTmCd},
                #{ntWkdyOperStarTm},
                #{ntWkdyOperEndTm},
                #{ntSatOperTmCd},
                #{ntSatOperStarTm},
                #{ntSatOperEndTm},
                #{ntHldyOperTmCd},
                #{ntHldyOperStarTm},
                #{ntHldyOperEndTm},
                #{wkFeeAplyCd},
                #{wkResDayFee},
                #{wkResWkFee},
                #{wkResFtFee},
                #{wkGnFrst30mFee},
                #{wkGnInt10mFee},
                #{wkGn1hFee},
                #{wkGnDayFee},
                #{wkFeeMnthPassPrc},
                #{wkFeeHfyrPassPrc},
                #{wkFeeMthdCd},
                #{wkFeeStlmtMthdCd},
                #{wkFeePayMthdOthr},
                #{ntFeeAplyCd},
                #{ntResDayFee},
                #{ntResWkFee},
                #{ntResNtFee},
                #{ntGnFrst30mFee},
                #{ntGnInt10mFee},
                #{ntGn1hFee},
                #{ntGnDayFee},
                #{ntFeeMnthPassPrc},
                #{ntFeeHfyrPassPrc},
                #{ntFeeMthdCd},
                #{ntFeeStlmtMthdCd},
                #{ntFeePayMthdOthr},
                #{prklotSignYn},
                #{tcktMchnYn},
                #{barrGteYn},
                #{exitAlrmYn},
                #{vehRcgnTpCd},
                #{wkPeakStrTm},
                #{wkPeakEndTm},
                #{wkPrkVehCnt},
                #{ntPeakStrTm},
                #{ntPeakEndTm},
                #{ntPrkVehCnt},
                #{prklotEntrLat},
                #{prklotEntrLon},
                #{bldg2fPrklotCd},
                #{fallPrevFcltyYn},
                #{slpYn},
                #{slp7gtAreaCnt},
                #{antislpFcltyYn},
                #{slpCtnGuidSignYn},
                #{spdBumpQty},
                #{stopLineQty},
                #{crswlkQty},
                #{partclrMatter},
                NOW(),
                #{updusrId},
                #{updusrIpAddr},
                NOW(),
                #{updusrId},
                #{updusrIpAddr})
    </insert>

    <!-- Î∂ÄÏÑ§Ï£ºÏ∞®Ïû• Ï†ïÎ≥¥ INSERT -->
    <insert id="insertAtchPrklotInfo" parameterType="com.psim.web.prk.vo.ParkingDetailVO">
        INSERT INTO cpk.tb_atch_prklot_info (prk_plce_manage_no, prk_plce_info_sn, prkplce_se,
                                             tot_prk_cnt, disab_prk_cnt, compact_prk_cnt, eco_prk_cnt, pregnant_prk_cnt,
                                             oper_mby_cd, mgr_org, mgr_org_tel_no, subordn_opertn_cd,
                                             trut_comp_nm, dirt_comp_nm,
                                             reg_dt, rgst_id, rgst_ip_addr,
                                             updt_dt, updusr_id, updusr_ip_addr)
        VALUES (#{prkPlceManageNo}, #{prkPlceInfoSn}, #{prkplceSe},
                #{totPrkCnt}, #{disabPrkCnt}, #{compactPrkCnt}, #{ecoPrkCnt}, #{pregnantPrkCnt},
                #{operMbyCd}, #{mgrOrg}, #{mgrOrgTelNo}, #{subordnOpertnCd},
                #{trutCompNm}, #{dirtCompNm},
                NOW(), #{updusrId}, #{updusrIpAddr},
                NOW(), #{updusrId}, #{updusrIpAddr})
    </insert>

    <!-- Î∂ÄÏÑ§Ï£ºÏ∞®Ïû• Ïö¥ÏòÅ Ï†ïÎ≥¥ INSERT -->
    <insert id="insertAtchPrklotOperInfo" parameterType="com.psim.web.prk.vo.ParkingDetailVO">
        INSERT INTO cpk.tb_atch_prklot_oper_info (prk_plce_manage_no, prk_plce_info_sn, prmisn_dt, use_insp_dt, plot_ar,
                                                  myeon_ar,
                                                  mech_prklot_tp_cd, mech_prklot_oper_yn, mech_prk_inop_cnt,
                                                  prk_fclty_tp_tot_flr_capa, prk_fclty_tp_tot_deck_capa,
                                                  indr_self_tot_space_cnt, indr_self_flr_cnt, indr_self_deck_cnt,
                                                  indr_mech_tot_space_cnt, indr_mech_flr_cnt, indr_mech_deck_cnt,
                                                  outdr_self_tot_space_cnt, outdr_self_flr_cnt, outdr_self_check_cnt,
                                                  outdr_mech_tot_space_cnt, outdr_mech_flr_cnt, outdr_mech_deck_cnt,
                                                  wkdy_oper_tm_cd, wkdy_tmbas_oper_str_tm, wkdy_tmbas_oper_end_tm,
                                                  sat_oper_tm_cd, sat_tmbas_oper_str_tm, sat_tmbas_oper_end_tm,
                                                  hldy_oper_tm_cd, hldy_tmbas_oper_str_tm, hldy_tmbas_oper_end_tm,
                                                  fee_imps_cd, fee_frst_30min_prc, fee_10min_prc, fee_1hr_prc,
                                                  fee_day_prc, fee_mnth_pass_prc, fee_hfyr_pass_prc,
                                                  fee_pay_mthd_cd, fee_pay_mthd_othr, fee_setl_mthd_cd,
                                                  prklot_sign_cd, tckt_mchn_yn, barr_gte_yn, exit_alrm_yn,
                                                  veh_rcgn_tp_cd,
                                                  wk_peak_str_tm, wk_peak_end_tm, wk_prk_veh_cnt,
                                                  nt_peak_str_tm, nt_peak_end_tm, nt_prk_veh_cnt,
                                                  prklot_entr_lat, prklot_entr_lon,
                                                  pbl_open_yn, prklot_info_prvsn_cnst_yn, bldg_2f_prklot_cd,
                                                  fall_prev_fclty_yn, slp_yn, antislp_fclty_yn, slp_ctn_guid_sign_yn,
                                                  spd_bump_qty, stop_line_qty, crswlk_qty,
                                                  guid_doc_yn, safe_insp_yn, mgr_yn, adm_yn,
                                                  al_zon,
                                                  partclr_matter,
                                                  reg_dt, rgst_id, rgst_ip_addr,
                                                  updt_dt, updusr_id, updusr_ip_addr)
        VALUES (#{prkPlceManageNo}, #{prkPlceInfoSn}, #{prmisnDt}, #{useInspDt}, #{plotAr}, #{myeonAr},
                #{mechPrklotTpCd}, #{mechPrklotOperYn}, #{mechPrkInopCnt},
                #{prkFcltyTpTotFlrCapa}, #{prkFcltyTpTotDeckCapa},
                #{indrSelfTotSpaceCnt}, #{indrSelfFlrCnt}, #{indrSelfDeckCnt},
                #{indrMechTotSpaceCnt}, #{indrMechFlrCnt}, #{indrMechDeckCnt},
                #{outdrSelfTotSpaceCnt}, #{outdrSelfFlrCnt}, #{outdrSelfCheckCnt},
                #{outdrMechTotSpaceCnt}, #{outdrMechFlrCnt}, #{outdrMechDeckCnt},
                #{wkdyOperTmCd}, #{wkdyTmbasOperStrTm}, #{wkdyTmbasOperEndTm},
                #{satOperTmCd}, #{satTmbasOperStrTm}, #{satTmbasOperEndTm},
                #{hldyOperTmCd}, #{hldyTmbasOperStrTm}, #{hldyTmbasOperEndTm},
                #{feeImpsCd}, #{feeFrst30minPrc}, #{fee10minPrc}, #{fee1hrPrc}, #{feeDayPrc}, #{feeMnthPassPrc},
                #{feeHfyrPassPrc},
                #{feePayMthdCd}, #{feePayMthdOthr}, #{feeSetlMthdCd},
                #{prklotSignCd}, #{tcktMchnYn}, #{barrGteYn}, #{exitAlrmYn}, #{vehRcgnTpCd},
                #{wkPeakStrTm}, #{wkPeakEndTm}, #{wkPrkVehCnt},
                #{ntPeakStrTm}, #{ntPeakEndTm}, #{ntPrkVehCnt},
                #{prklotEntrLat}, #{prklotEntrLon},
                #{pblOpenYn}, #{prklotInfoPrvsnCnstYn}, #{bldg2fPrklotCd},
                #{fallPrevFcltyYn}, #{slpYn}, #{antislpFcltyYn}, #{slpCtnGuidSignYn},
                #{spdBumpQty}, #{stopLineQty}, #{crswlkQty},
                #{guidDocYn}, #{safeInspYn}, #{mgrYn}, #{admYn},
                #{chrgGrdCd},
                #{partclrMatter},
                NOW(), #{updusrId}, #{updusrIpAddr},
                NOW(), #{updusrId}, #{updusrIpAddr})
    </insert>

    <!-- üî• ÏßÄÎèÑÏö© Ï£ºÏ∞®Ïû• Î™©Î°ù Ï°∞Ìöå (Ï¢åÌëú Ìè¨Ìï® + ÏãúÎèÑ/ÏãúÍµ∞Íµ¨ ÌïÑÌÑ∞) -->
    <select id="selectParkingListForMap" parameterType="map" resultType="com.psim.web.prk.vo.ParkingListVO">
        SELECT
        cpk.FN_GET_CODE_NM(tbppi.prgs_sts_cd, 'PRK_013') as prgsStsCd,
        tcl.sido_cd as sidoCd,
        tcl.sido_nm as sidoNm,
        tcl.sigungu_cd as sigunguCd,
        tcl.sigungu_nm as sigunguNm,
        tcl.emd_cd as emdCd,
        tcl.lgal_emd_nm as lgalEmdNm,
        tpdpi.zip as zip,
        tpdpi.dtadd as dtadd,
        tcu.user_nm as userNm,
        cpk.FN_GET_CODE_NM(tpdpi.prk_plce_type, 'P_PRKPLCE_SE') as prkPlceType,
        tpdpi.prkplce_nm as prkplceNm,
        tbppi.biz_per_prk_mng_no as bizPerPrkMngNo,
        tbppi.prk_biz_mng_no as prkBizMngNo,
        tbppi.prk_plce_manage_no as prkPlceManageNo,
        tbppi.prk_plce_info_sn as prkPlceInfoSn,
        tpdpi.prk_plce_lat as prkPlceLat,
        tpdpi.prk_plce_lon as prkPlceLon
        FROM cpk.tb_prk_def_plce_info tpdpi
        LEFT JOIN cpk.tb_co_ldong tcl
        ON tpdpi.ldong_cd = tcl.ldong_cd
        LEFT JOIN cpk.tb_biz_per_prklot_info tbppi
        ON tpdpi.prk_plce_manage_no = tbppi.prk_plce_manage_no
        AND tpdpi.prk_plce_info_sn = tbppi.prk_plce_info_sn
        LEFT JOIN cpk.tb_co_user tcu
        ON tbppi.srvy_id = tcu.user_id
        <include refid="parkingCommonWhere"/>
        <!-- üî• Ï¢åÌëúÍ∞Ä ÏûàÎäî Ï£ºÏ∞®Ïû•Îßå Ï°∞Ìöå -->
        AND tpdpi.prk_plce_lat IS NOT NULL
        AND tpdpi.prk_plce_lon IS NOT NULL
        AND tpdpi.prk_plce_lat != ''
        AND tpdpi.prk_plce_lon != ''
        ORDER BY tpdpi.prkplce_nm ASC
    </select>

    <update id="updateStatusToPending" parameterType="map">
        UPDATE cpk.tb_biz_per_prklot_info
        SET prgs_sts_cd = '20', /* ÏäπÏù∏ ÎåÄÍ∏∞ ÏÉÅÌÉú ÏΩîÎìú */
        updt_dt = NOW()
        WHERE (prk_plce_manage_no, prk_plce_info_sn) IN
        <foreach collection="parkingList" item="item" open="(" separator="," close=")">
            (#{item.prkPlceManageNo}, #{item.prkPlceInfoSn})
        </foreach>
    </update>

    <select id="generateParkingManageNo" parameterType="map" resultType="string">
        SELECT cpk.fn_create_srvy_prk_plce_manage_no2(
                       CAST(#{zipCode} AS VARCHAR),
                       CAST(#{prkplceSe} AS VARCHAR),
                       CAST(#{operMbyCd} AS VARCHAR),
                       CAST(#{prkPlceType} AS VARCHAR)
               ) AS prk_plce_manage_no
    </select>

    <!-- üî• Ï£ºÏ∞®Ïû•Ï†ïÎ≥¥ÏùºÎ†®Î≤àÌò∏ ÏÉùÏÑ± (FOR UPDATEÎ°ú ÎèôÏãúÏÑ± Ï†úÏñ¥) -->
    <select id="generateParkingInfoSn" parameterType="string" resultType="int">
        SELECT COALESCE(MAX(prk_plce_info_sn), 0) + 1
        FROM cpk.tb_prk_def_plce_info
    </select>

    <!-- üî• ÏÇ¨ÏóÖÎ≥ÑÏ£ºÏ∞®Í¥ÄÎ¶¨Î≤àÌò∏ ÏÉùÏÑ± -->
    <select id="generateBizPerPrkMngNo" resultType="string">
        SELECT 'BP' || TO_CHAR(NOW(), 'YYYYMMDDHH24MISS') ||
               LPAD(CAST(FLOOR(RANDOM() * 1000) AS TEXT), 3, '0')
    </select>

    <!-- üî• [STEP 1/4] Ï£ºÏ∞®Ïû• Í∏∞Î≥∏ Ï†ïÎ≥¥ INSERT -->
    <insert id="insertPrkDefPlceInfo" parameterType="com.psim.web.prk.vo.ParkingDetailVO">
        INSERT INTO cpk.tb_prk_def_plce_info (prk_plce_info_sn,
                                              prk_plce_manage_no,
                                              prk_plce_type,
                                              prkplce_nm,
                                              sido_cd,
                                              sigungu_cd,
                                              zip,
                                              dtadd,
                                              ldong_cd,
                                              prk_plce_lat,
                                              prk_plce_lon,
                                              bdnbr,
                                              lnm_mnno,
                                              lnm_sbno,
                                              mntn_yn,
                                              li_cd,
                                              roadadd,
                                              emd_cd,
                                              reg_dt,
                                              rgst_id,
                                              rgst_ip_addr,
                                              updt_dt,
                                              updusr_id,
                                              updusr_ip_addr,
                                              closed_yn)
        VALUES (#{prkPlceInfoSn},
                #{prkPlceManageNo},
                #{prkPlceType},
                #{prkplceNm},
                #{sidoCd},
                #{sigunguCd},
                #{zip},
                #{dtadd},
                #{ldongCd},
                #{prkPlceLat},
                #{prkPlceLon},
                #{bdnbr},
                #{lnmMnno},
                #{lnmSbno},
                #{mntnYn},
                #{liCd},
                #{rnmadr},
                #{emdCd},
                NOW(),
                #{updusrId},
                #{updusrIpAddr},
                NOW(),
                #{updusrId},
                #{updusrIpAddr},
                'N')
    </insert>

    <!-- üî• [STEP 2/4] ÏÇ¨ÏóÖÎ≥Ñ Ï£ºÏ∞®Ïû• Ï†ïÎ≥¥ INSERT -->
    <insert id="insertBizPerPrklotInfo" parameterType="com.psim.web.prk.vo.ParkingDetailVO">
        INSERT INTO cpk.tb_biz_per_prklot_info (prk_biz_mng_no,
                                                biz_per_prk_mng_no,
                                                prk_plce_manage_no,
                                                prk_plce_info_sn,
                                                prgs_sts_cd,
                                                reg_dt,
                                                rgst_id,
                                                rgst_ip_addr,
                                                updt_dt,
                                                updusr_id,
                                                updusr_ip_addr)
        VALUES (#{prkBizMngNo},
                #{bizPerPrkMngNo},
                #{prkPlceManageNo},
                #{prkPlceInfoSn},
                '10',
                NOW(),
                #{updusrId},
                #{updusrIpAddr},
                NOW(),
                #{updusrId},
                #{updusrIpAddr})
    </insert>

    <!-- üî• [STEP 3/4] ÎÖ∏ÏÉÅÏ£ºÏ∞®Ïû• Ï†ïÎ≥¥ INSERT -->
    <insert id="insertOnstrPrklotInfo" parameterType="com.psim.web.prk.vo.ParkingDetailVO">
        INSERT INTO cpk.tb_onstr_prklot_info (prk_plce_manage_no,
                                              prk_plce_info_sn,
                                              prkplce_se,
                                              tot_prk_cnt,
                                              disab_prk_cnt,
                                              compact_prk_cnt,
                                              eco_prk_cnt,
                                              pregnant_prk_cnt,
                                              prk_oper_mthd_cd,
                                              oper_mby_cd,
                                              mgr_org,
                                              mgr_org_tel_no,
                                              subordn_opertn_cd,
                                              reg_dt,
                                              rgst_id,
                                              rgst_ip_addr,
                                              updt_dt,
                                              updusr_id,
                                              updusr_ip_addr)
        VALUES (#{prkPlceManageNo},
                #{prkPlceInfoSn},
                #{prkplceSe},
                #{totPrkCnt},
                #{disabPrkCnt},
                #{compactPrkCnt},
                #{ecoPrkCnt},
                #{pregnantPrkCnt},
                #{prkOperMthdCd},
                #{operMbyCd},
                #{mgrOrg},
                #{mgrOrgTelNo},
                #{subordnOpertnCd},
                NOW(),
                #{updusrId},
                #{updusrIpAddr},
                NOW(),
                #{updusrId},
                #{updusrIpAddr})
            /* PK Ï∂©Îèå(Ï§ëÎ≥µ) Î∞úÏÉù Ïãú UPDATEÎ°ú Ï†ÑÌôò */
            ON CONFLICT (prk_plce_manage_no, prk_plce_info_sn)
            DO
        UPDATE SET
            tot_prk_cnt = EXCLUDED.tot_prk_cnt,
            disab_prk_cnt = EXCLUDED.disab_prk_cnt,
            compact_prk_cnt = EXCLUDED.compact_prk_cnt,
            eco_prk_cnt = EXCLUDED.eco_prk_cnt,
            pregnant_prk_cnt = EXCLUDED.pregnant_prk_cnt,
            prk_oper_mthd_cd = EXCLUDED.prk_oper_mthd_cd,
            oper_mby_cd = EXCLUDED.oper_mby_cd,
            mgr_org = EXCLUDED.mgr_org,
            mgr_org_tel_no = EXCLUDED.mgr_org_tel_no,
            subordn_opertn_cd = EXCLUDED.subordn_opertn_cd,
            updt_dt = NOW(),
            updusr_id = EXCLUDED.updusr_id,
            updusr_ip_addr = EXCLUDED.updusr_ip_addr
    </insert>

    <!-- üî• [STEP 4/4] ÎÖ∏ÏÉÅÏ£ºÏ∞®Ïû• Ïö¥ÏòÅ Ï†ïÎ≥¥ INSERT -->
    <insert id="insertOnstrPrklotOperInfo" parameterType="com.psim.web.prk.vo.ParkingDetailVO">
        INSERT INTO cpk.tb_onstr_prklot_oper_info (prk_plce_manage_no,
                                                   prk_plce_info_sn,
                                                   dynt_dv_cd,
                                                   wk_zon,
                                                   wk_wkdy_oper_tm_cd,
                                                   wk_wkdy_oper_star_tm,
                                                   wk_wkdy_oper_end_tm,
                                                   wk_sat_oper_tm_cd,
                                                   wk_sat_oper_star_tm,
                                                   wk_sat_oper_end_tm,
                                                   wk_hldy_oper_tm_cd,
                                                   wk_hldy_oper_star_tm,
                                                   wk_hldy_oper_end_tm,
                                                   nt_zon,
                                                   nt_wkdy_oper_tm_cd,
                                                   nt_wkdy_oper_star_tm,
                                                   nt_wkdy_oper_end_tm,
                                                   nt_sat_oper_tm_cd,
                                                   nt_sat_oper_star_tm,
                                                   nt_sat_oper_end_tm,
                                                   nt_hldy_oper_tm_cd,
                                                   nt_hldy_oper_star_tm,
                                                   nt_hldy_oper_end_tm,
                                                   wk_fee_aply_cd,
                                                   wk_res_day_fee,
                                                   wk_res_wk_fee,
                                                   wk_res_ft_fee,
                                                   wk_res_nt_fee,
                                                   wk_gn_frst_30m_fee,
                                                   wk_gn_int_10m_fee,
                                                   wk_gn_1h_fee,
                                                   wk_gn_day_fee,
                                                   wk_fee_mnth_pass_prc,
                                                   wk_fee_hfyr_pass_prc,
                                                   wk_fee_mthd_cd,
                                                   wk_fee_stlmt_mthd_cd,
                                                   wk_fee_pay_mthd_othr,
                                                   nt_fee_aply_cd,
                                                   nt_res_day_fee,
                                                   nt_res_wk_fee,
                                                   nt_res_ft_fee,
                                                   nt_res_nt_fee,
                                                   nt_gn_frst_30m_fee,
                                                   nt_gn_int_10m_fee,
                                                   nt_gn_1h_fee,
                                                   nt_gn_day_fee,
                                                   nt_fee_mnth_pass_prc,
                                                   nt_fee_hfyr_pass_prc,
                                                   nt_fee_mthd_cd,
                                                   nt_fee_stlmt_mthd_cd,
                                                   nt_fee_pay_mthd_othr,
                                                   prklot_sign_yn,
                                                   slp_sec_yn,
                                                   sixle_cnt,
                                                   sixgt_cnt,
                                                   antislp_fclty_yn,
                                                   slp_ctn_guid_sign_yn,
                                                   partclr_matter,
                                                   reg_dt,
                                                   rgst_id,
                                                   rgst_ip_addr,
                                                   updt_dt,
                                                   updusr_id,
                                                   updusr_ip_addr)
        VALUES (#{prkPlceManageNo},
                #{prkPlceInfoSn},
                #{dyntDvCd},
                #{wkZon},
                #{wkWkdyOperTmCd},
                #{wkWkdyOperStarTm},
                #{wkWkdyOperEndTm},
                #{wkSatOperTmCd},
                #{wkSatOperStarTm},
                #{wkSatOperEndTm},
                #{wkHldyOperTmCd},
                #{wkHldyOperStarTm},
                #{wkHldyOperEndTm},
                #{ntZon},
                #{ntWkdyOperTmCd},
                #{ntWkdyOperStarTm},
                #{ntWkdyOperEndTm},
                #{ntSatOperTmCd},
                #{ntSatOperStarTm},
                #{ntSatOperEndTm},
                #{ntHldyOperTmCd},
                #{ntHldyOperStarTm},
                #{ntHldyOperEndTm},
                #{wkFeeAplyCd},
                #{wkResDayFee},
                #{wkResWkFee},
                #{wkResFtFee},
                #{wkResNtFee},
                #{wkGnFrst30mFee},
                #{wkGnInt10mFee},
                #{wkGn1hFee},
                #{wkGnDayFee},
                #{wkFeeMnthPassPrc},
                #{wkFeeHfyrPassPrc},
                #{wkFeeMthdCd},
                #{wkFeeStlmtMthdCd},
                #{wkFeePayMthdOthr},
                #{ntFeeAplyCd},
                #{ntResDayFee},
                #{ntResWkFee},
                #{ntResFtFee},
                #{ntResNtFee},
                #{ntGnFrst30mFee},
                #{ntGnInt10mFee},
                #{ntGn1hFee},
                #{ntGnDayFee},
                #{ntFeeMnthPassPrc},
                #{ntFeeHfyrPassPrc},
                #{ntFeeMthdCd},
                #{ntFeeStlmtMthdCd},
                #{ntFeePayMthdOthr},
                #{prklotSignYn},
                #{slpSecYn},
                #{sixleCnt},
                #{sixgtCnt},
                #{antislpFcltyYn},
                #{slpCtnGuidSignYn},
                #{partclrMatter},
                NOW(),
                #{updusrId},
                #{updusrIpAddr},
                NOW(),
                #{updusrId},
                #{updusrIpAddr})
    </insert>
</mapper>
